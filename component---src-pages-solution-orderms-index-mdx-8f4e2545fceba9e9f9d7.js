(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{dnaX:function(e,t,a){"use strict";a.r(t),a.d(t,"_frontmatter",(function(){return o})),a.d(t,"default",(function(){return m}));a("91GP"),a("rGqo"),a("yt8O"),a("Btvt"),a("RW0V"),a("q1tI");var n=a("7ljp"),r=a("013z");a("qKvR");function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var o={},c=function(e){return function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),Object(n.b)("div",t)}},l=c("PageDescription"),s=c("AnchorLinks"),p=c("AnchorLink"),b={_frontmatter:o},d=r.a;function m(e){var t=e.components,a=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,["components"]);return Object(n.b)(d,i({},b,a,{components:t,mdxType:"MDXLayout"}),Object(n.b)(l,{mdxType:"PageDescription"},"This microservice manages vaccine order for a world wide demand and distribution."),Object(n.b)(s,{mdxType:"AnchorLinks"},Object(n.b)(p,{mdxType:"AnchorLink"},"Overview"),Object(n.b)(p,{mdxType:"AnchorLink"},"Build"),Object(n.b)(p,{mdxType:"AnchorLink"},"Run"),Object(n.b)(p,{mdxType:"AnchorLink"},"Usage Details")),Object(n.b)("h2",null,"Overview"),Object(n.b)("p",null,"This project implements a very simple event driven microservice to support the Create, Read, Update, and Delete of vaccine orders. The sale representative uses his mobile device to enter information about an order for a countries or a county within a country. "),Object(n.b)("p",null," ",Object(n.b)("span",i({parentName:"p"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(n.b)("span",i({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"52.43055555555556%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAACHklEQVQoz22Sy2vUUBTGs6m4FMS14D/R4kqoOxfiRtCNuHQjgotaijJgUREG6UoRKlZk3CiKIEOrrS60VG0tdeyMqaMy0zgznXaS5nWT+0g+z01q1dJz+fIg537nd8+JIZTCm4U6pubMTDPz38C4gI6UVn5NoVRCUpBSZd+abRsXis8xOj6Ny7cnUbg7hSCKYdhegP2DBfQNDGPv4RHsO3IFS1ULqUwQ+jGikIMFHBHj4LHM7joWl1dx8NgoTo88xOC5O+g/MwbHD2Fo1+KDady4N4nixEuMlV7DouqSNjMyi5kAI2POZU6a5ISrazZODU/g5NB9nLg4jvM3nyCMOQz8iUSTeNuv6dbKntM0M9aEWjrmK0309Q/hwNEC9gxcwqHj13PCFx87uPV4BY11hkRJBGEE1/UQUCviiI4p/koIgQ1nM6N0vBCl8geU31bwbGYRT0lcShjXHpk4e3UOs6ZNdRVUmmD5RxOzSyZsNyDGBJIKqSQhUoUF04LVY9gt9ImMquWj/KkLP5I0wbzh777UUXr1Hh3b/S9dB6cpx0SqNwsikjR5saWEYIx/K+hEjd3quai3umi02mhaRNRuZxs4KaIcIXNDbbBThj6KoH9MJzCapO34CKmP3bUN1Gor+Gp+x+dKFY1mCy71bb3n0TRFRqwN0h3LSLc/UAcZA3dcxDQUZm+i96uFRs1E52cDEQ2Dez7ingNJeTp/N8PfIjzZpn2L7/8AAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(n.b)("img",i({parentName:"span"},{className:"gatsby-resp-image-image",alt:"vaccine order 1",title:"vaccine order 1",src:"/vaccine-solution-main/static/149aa90647f6235a6c01a257153a05e8/3cbba/vaccine-order-1.png",srcSet:["/vaccine-solution-main/static/149aa90647f6235a6c01a257153a05e8/7fc1e/vaccine-order-1.png 288w","/vaccine-solution-main/static/149aa90647f6235a6c01a257153a05e8/a5df1/vaccine-order-1.png 576w","/vaccine-solution-main/static/149aa90647f6235a6c01a257153a05e8/3cbba/vaccine-order-1.png 1152w","/vaccine-solution-main/static/149aa90647f6235a6c01a257153a05e8/dd02b/vaccine-order-1.png 1540w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    ")),Object(n.b)("p",null,"The component writes to a database (DB2) all the order received, but also produce records to Blockchains and once the order is ready calls the Vaccine Order & Reefer Optimization service to get an updated schedule of vaccine lots to ship by airplane. At each order’s state modification, events are sent to an event backbone."),Object(n.b)("p",null,"The service is created from an ",Object(n.b)("a",i({parentName:"p"},{href:"https://appsody.dev/"}),"Appsody")," stack and packaged as docker images, deployed on Openshift. The Event backbone is IBM Event Streams deliver as part of cloud pack for integration and installed via operator. This ",Object(n.b)("a",i({parentName:"p"},{href:"https://www.youtube.com/watch?v=nSza-RwvxSE"}),"video on the last event streams release")," presents the installation process and the new capabilities."),Object(n.b)("p",null,Object(n.b)("strong",{parentName:"p"},"Github repository:")," ",Object(n.b)("a",i({parentName:"p"},{href:"https://github.ibm.com/vaccine-cold-chain/vaccine-order-mgr"}),"Vaccine-order-mgr")),Object(n.b)("p",null,Object(n.b)("strong",{parentName:"p"},"Order Life Cycle")),Object(n.b)("p",null,"The order follows a set of states as described in the following diagram:"),Object(n.b)("p",null," ",Object(n.b)("span",i({parentName:"p"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(n.b)("span",i({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"46.875%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAACH0lEQVQoz02Sy08TURSH+0e5cunGhVt3Jm4lujQRjS6UEA0LYkh8JcQFSlKxaMQSw0MTy6MEiAoaWh4VppS20ulr2s7r3pn5vHMF9WzOuefO/c7vnDMJlE2uVBl5/5Pdak+dIuyuh93xiKIovsb3BMKXOCof+1DlwijUsZQBQkg8R+g48UbBRj+WyB80MVaLbMwWsBoOwpO4UmD6Hbpth2OjTafpIAOFC4Qu7No+tZJFz3K1CM8VJLaOunwvNCjvVBi/9ZknfbMUczWtrKkebBh1HvfNcPd8ihc3MzpfOjSpmhYvb2e4c+4VY/0ZwjDURRL6CwQd4Sgv9UmGPsdlU8eu59OodtldO+QoX9G5ngzpuB5HO3VW09vkFvZwVdvRKTC/ViX5IEs2lUNYPZIDSwxfTvN1Zl/NK2B9usDEUJZ0Ko9Qs4vCQLUu2PxkMDWyxtLUjgIG/4DLk9sMXXynQMu47R5vBxd5enWOb/MHSq0keU8VuDTNh+EVNT4fR6nz1XxT91cYuDDJxECWIDgBxtv63xzV4lahRsVonrQv1ZYl5f06RaNGy/aUukAD/1j018esREyNB1qt1TFKZX6ZLUauzHL9zBhzzzfVQ18vqv/sOKM3Mri+T6/VwnEcFl/nmRjMspDMESiGVhidkK1ul2bbomVZlAt19jeOaZu2rl3ea/AjU8Q8bOMLQcmo4Ng26UdfeHZtnqmH6/ofjFm/AeF6it0arcCoAAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(n.b)("img",i({parentName:"span"},{className:"gatsby-resp-image-image",alt:"vaccine order 2",title:"vaccine order 2",src:"/vaccine-solution-main/static/fe18efd58d03fc4975aa0abf3e08904c/3cbba/vaccine-order-2.png",srcSet:["/vaccine-solution-main/static/fe18efd58d03fc4975aa0abf3e08904c/7fc1e/vaccine-order-2.png 288w","/vaccine-solution-main/static/fe18efd58d03fc4975aa0abf3e08904c/a5df1/vaccine-order-2.png 576w","/vaccine-solution-main/static/fe18efd58d03fc4975aa0abf3e08904c/3cbba/vaccine-order-2.png 1152w","/vaccine-solution-main/static/fe18efd58d03fc4975aa0abf3e08904c/1b26f/vaccine-order-2.png 1672w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    ")),Object(n.b)("p",null,Object(n.b)("strong",{parentName:"p"},"Kafka topics produced to:")),Object(n.b)("p",null,"The service produces to ",Object(n.b)("inlineCode",{parentName:"p"},"orders")," topic. Below is a representation of a Strimzi topic definition:"),Object(n.b)("pre",null,Object(n.b)("code",i({parentName:"pre"},{className:"language-yaml"}),"apiVersion: eventstreams.ibm.com/v1beta1\nkind: KafkaTopic\nmetadata:\n  name: orders\n  namespace: cp4i\nspec:\n  partitions: 3\n  replicas: 3\n  config:\n    retention.ms: 7200000\n    segment.bytes: 1073741824\n")),Object(n.b)("p",null,Object(n.b)("strong",{parentName:"p"},"Events produced:")),Object(n.b)("p",null,"We will simplify the process and aggregate in the following event types:"),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},"orderCreated"),Object(n.b)("li",{parentName:"ul"},"orderUpdated"),Object(n.b)("li",{parentName:"ul"},"orderCancelled"),Object(n.b)("li",{parentName:"ul"},"orderClosed")),Object(n.b)("p",null,"Some events are related to the vaccine lot"),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},"lotAssignedToOrder"),Object(n.b)("li",{parentName:"ul"},"lotLoaded"),Object(n.b)("li",{parentName:"ul"},"lotDelivered")),Object(n.b)("h2",null,"Build"),Object(n.b)("p",null,"This microservice is built using the ",Object(n.b)("a",i({parentName:"p"},{href:"https://appsody.dev/"}),"Appsody")," development framework. The ",Object(n.b)("a",i({parentName:"p"},{href:"https://appsody.dev/docs/installing/installing-appsody"}),"Appsody CLI")," is a required prerequisite for building the application locally."),Object(n.b)("p",null,"Appsody will build the application by pulling the contents of the Quarkus Appsody Stack it is based on and then performs the local application build inside the containerized environment:"),Object(n.b)("p",null,Object(n.b)("inlineCode",{parentName:"p"},"appsody build -t vaccine-cold-chain/vaccine-order-mgr:0.0.1 [--push]")),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},"You can optionally specify a container tag (0.0.1). If left blank, ",Object(n.b)("inlineCode",{parentName:"li"},"latest")," will be used."),Object(n.b)("li",{parentName:"ul"},"You can optionally supply the ",Object(n.b)("inlineCode",{parentName:"li"},"--push")," flag to automatically push the built image to specified remote repository.")),Object(n.b)("p",null,"Performing an Appsody build will update the ",Object(n.b)("inlineCode",{parentName:"p"},"app-deploy.yaml")," file in the same directory with current information for the application image, labels, and annotations fields."),Object(n.b)("h2",null,"Run"),Object(n.b)("h3",null,"Pre requisites"),Object(n.b)("p",null,"The orders are persisted in an external DB2 instance running on IBM Cloud Pack. You need to get the username and password to connect to the DB2 instance with the jdbc URL (something like jdbc:db2://dashdb-…:50001/BLUDB)"),Object(n.b)("h3",null,"Deployment Parameters"),Object(n.b)("p",null,"The following deployment parameters are defined in the ",Object(n.b)("inlineCode",{parentName:"p"},"app-deploy.yaml")," file:"),Object(n.b)("table",null,Object(n.b)("thead",{parentName:"table"},Object(n.b)("tr",{parentName:"thead"},Object(n.b)("th",i({parentName:"tr"},{align:null}),"Name"),Object(n.b)("th",i({parentName:"tr"},{align:null}),"Required"),Object(n.b)("th",i({parentName:"tr"},{align:null}),"Description"))),Object(n.b)("tbody",{parentName:"table"},Object(n.b)("tr",{parentName:"tbody"},Object(n.b)("td",i({parentName:"tr"},{align:null}),"KAFKA_BROKERS"),Object(n.b)("td",i({parentName:"tr"},{align:null}),"YES"),Object(n.b)("td",i({parentName:"tr"},{align:null}),"Comma-separated list of Kafka brokers to connect to")),Object(n.b)("tr",{parentName:"tbody"},Object(n.b)("td",i({parentName:"tr"},{align:null}),"KAFKA_APIKEY"),Object(n.b)("td",i({parentName:"tr"},{align:null}),"NO"),Object(n.b)("td",i({parentName:"tr"},{align:null}),"API Key used to connect to SASL-secured Kafka brokers. This is required when connecting to IBM Event Streams clusters.")),Object(n.b)("tr",{parentName:"tbody"},Object(n.b)("td",i({parentName:"tr"},{align:null}),"TRUSTSTORE_ENABLED"),Object(n.b)("td",i({parentName:"tr"},{align:null}),"NO"),Object(n.b)("td",i({parentName:"tr"},{align:null}),"Required to be set to ",Object(n.b)("inlineCode",{parentName:"td"},"true")," when connecting to IBM Event Streams on the IBM Cloud Pak for Integration (CP4I).")),Object(n.b)("tr",{parentName:"tbody"},Object(n.b)("td",i({parentName:"tr"},{align:null}),"TRUSTSTORE_PATH"),Object(n.b)("td",i({parentName:"tr"},{align:null}),"NO"),Object(n.b)("td",i({parentName:"tr"},{align:null}),"The local path to the required truststore file when connecting to IBM Event Streams on CP4I. See ",Object(n.b)("a",i({parentName:"td"},{href:"#volume-mounts"}),Object(n.b)("strong",{parentName:"a"},"Volume Mounts"))," below.")),Object(n.b)("tr",{parentName:"tbody"},Object(n.b)("td",i({parentName:"tr"},{align:null}),"TRUSTSTORE_PWD"),Object(n.b)("td",i({parentName:"tr"},{align:null}),"NO"),Object(n.b)("td",i({parentName:"tr"},{align:null}),"The password for the truststore file used for IBM Event Streams server verification.")),Object(n.b)("tr",{parentName:"tbody"},Object(n.b)("td",i({parentName:"tr"},{align:null}),"DBUSER"),Object(n.b)("td",i({parentName:"tr"},{align:null}),"YES"),Object(n.b)("td",i({parentName:"tr"},{align:null}),"Database user")),Object(n.b)("tr",{parentName:"tbody"},Object(n.b)("td",i({parentName:"tr"},{align:null}),"DBPWD"),Object(n.b)("td",i({parentName:"tr"},{align:null}),"YES"),Object(n.b)("td",i({parentName:"tr"},{align:null}),"Database user password")),Object(n.b)("tr",{parentName:"tbody"},Object(n.b)("td",i({parentName:"tr"},{align:null}),"SSLJDBCURL"),Object(n.b)("td",i({parentName:"tr"},{align:null}),"YES"),Object(n.b)("td",i({parentName:"tr"},{align:null}),"JDBC URL to connect to the database")))),Object(n.b)("p",null,"You can define a ",Object(n.b)("inlineCode",{parentName:"p"},"setenv.sh")," script to export the environment variables. The ",Object(n.b)("inlineCode",{parentName:"p"},"scripts")," folder has a template for this file with the environment variables needed to run locally."),Object(n.b)("h3",null,"Run Locally"),Object(n.b)("p",null,"When running the microservice locally you must specify all the required ",Object(n.b)("a",i({parentName:"p"},{href:"#deployment-parameters"}),"deployment parameters")," from above as environment variables. When using ",Object(n.b)("inlineCode",{parentName:"p"},"appsody run")," use the ",Object(n.b)("inlineCode",{parentName:"p"},"--docker-options")," flag being passed in from the Appsody CLI command. If you use ",Object(n.b)("inlineCode",{parentName:"p"},"./mvnw quarkus:dev")," be sure to have exported the environment variable."),Object(n.b)("p",null,Object(n.b)("strong",{parentName:"p"},"With Quarkus:")),Object(n.b)("pre",null,Object(n.b)("code",i({parentName:"pre"},{className:"language-shell"}),"source ./scripts/setenv.sh\n./mvnw quarkus:dev\n")),Object(n.b)("p",null,Object(n.b)("strong",{parentName:"p"},"With Appsody:")," "),Object(n.b)("pre",null,Object(n.b)("code",i({parentName:"pre"},{className:"language-shell"}),'source ./scripts/setenv.sh\n\nappsody run --docker-options "-e KAFKA_BROKERS=$KAFKA_BROKERS -e KAFKA_APIKEY=$KAFKA_APIKEY -e DBPWD=$DBPWD -e DBUSER=$DBUSER -e SSLJDBCURL=$SSLJDBCURL  -v $(pwd)/certs/es-cert.jks:/deployments/certs/es-cert.jks"\n')),Object(n.b)("p",null,"For more details on running the microservice locally, consult the Appsody run documentation as well as the deployment information contained in the app-deploy.yaml file."),Object(n.b)("h3",null,"Volume mounts"),Object(n.b)("p",null,"The order manager microservice requires up to one file to be injected at runtime for proper operation. As noted in the ",Object(n.b)("inlineCode",{parentName:"p"},"TRUSTSTORE_PATH")," parameter above, these files are SSL-based certificates which are required to verify the identity of the external service when calling it. These files are provided as ",Object(n.b)("inlineCode",{parentName:"p"},'--docker-options "-v host-src:container-dest ..."')," when running the microservice locally and as a Volume Mount when running the microservice on a Kubernetes cluster."),Object(n.b)("p",null,"The ",Object(n.b)("inlineCode",{parentName:"p"},"TRUSTSTORE_PATH")," parameter is documented in the ",Object(n.b)("strong",{parentName:"p"},"Event Streams Certificates")," section of the ",Object(n.b)("a",i({parentName:"p"},{href:"/vaccine-solution-main/microservices/prereqs/#ibm-event-streams-on-redhat-openshift-container-platform"}),"Prerequisites")," page. The Appsody run command should include a parameter similar to ",Object(n.b)("inlineCode",{parentName:"p"},"-v ./certs/es-cert.jks:/config/resources/security/es-cert.jks")," in its ",Object(n.b)("inlineCode",{parentName:"p"},"--docker-options")," string to run this microservice locally."),Object(n.b)("p",null,Object(n.b)("strong",{parentName:"p"},"Example:")," ",Object(n.b)("inlineCode",{parentName:"p"},'appsody run --docker-options "-v /Users/myuser/Downloads/es-cert.jks:/config/resources/security/es-ssl/es-cert.jks" ...')),Object(n.b)("h3",null,"Running on Openshift"),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},Object(n.b)("p",{parentName:"li"},"Define a config map for the kafka brokers URL coming from the Event streams cluster connection panel:"),Object(n.b)("span",i({parentName:"li"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"728px"}}),"\n      ",Object(n.b)("span",i({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"63.888888888888886%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAABXElEQVQ4y32Taa7CMAyEeyPO0N9wTS7BHxDXAAnKvkPLvs7TZ8kolPAijeK4jT0eO8nj8dBoNNJgMNB6vdZ8PtdwOFSWZdput2K9Xq8P+AptX8nz+dRms9FisbAA2EVR6HK56Ha7RS+GgcvfEhjVajVVq1WlaapKpaJ6va7T6aTZbKY8z3U8Hi0R/wJ89/v9K7gFPJ/ParfbarVaajabajQaVi5SOEsuY1+v1/eZyqIBOfiPBAf7/d6YIMNyubQdX6z0Lw3JNh6PLYCXiI8EzgbELpebBRIudbtdQ6/XM0aHw8EYhaBR7sd2DaNd3u12Wq1WHx2m9F87cJlCndHdAjJ/k8nESgbT6dSAFPix8XuXXR78fKcqyMDemkJ0yoEdiJVK4hCwCW3X2JrCmJAB568L3hxHbL2b0ul01O/37Qny7CgVmx3g4+wyMAk/u0x2npwPa5mZn0P7vzn8A4PU5T9m/FD/AAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(n.b)("img",i({parentName:"span"},{className:"gatsby-resp-image-image",alt:"3",title:"3",src:"/vaccine-solution-main/static/630c23bfb531d23ac3f5250dfd04aa92/08ad8/es-cluster-connect.png",srcSet:["/vaccine-solution-main/static/630c23bfb531d23ac3f5250dfd04aa92/7fc1e/es-cluster-connect.png 288w","/vaccine-solution-main/static/630c23bfb531d23ac3f5250dfd04aa92/a5df1/es-cluster-connect.png 576w","/vaccine-solution-main/static/630c23bfb531d23ac3f5250dfd04aa92/08ad8/es-cluster-connect.png 728w"],sizes:"(max-width: 728px) 100vw, 728px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "),Object(n.b)("pre",{parentName:"li"},Object(n.b)("code",i({parentName:"pre"},{className:"language-shell"}),"oc create configmap kafka-brokers --from-literal=brokers='es-cp4i-ibm-es-proxy-route-bootstrap-eventstreams-cp4i.gse-eda-demo-202005-fa9ee67c9ab6a7791435450358e564cc-0000.us-south.containers.appdomain.cloud:443' -n vaccine-cold-chain\n\n"))),Object(n.b)("li",{parentName:"ul"},Object(n.b)("p",{parentName:"li"},"Define a secret for the event streams API key"),Object(n.b)("pre",{parentName:"li"},Object(n.b)("code",i({parentName:"pre"},{className:"language-shell"}),"oc create secret generic es-cp4i-apikey --from-literal=binding='b77......tgMJZ' -n vaccine-cold-chain\n"))),Object(n.b)("li",{parentName:"ul"},Object(n.b)("p",{parentName:"li"},"Add a secret for the java truststore, downloaded from Event Stream console or using the CLI ",Object(n.b)("inlineCode",{parentName:"p"},"cloudctl es certificates --format jks")),Object(n.b)("pre",{parentName:"li"},Object(n.b)("code",i({parentName:"pre"},{className:"language-shell"}),"oc create secret generic es-truststore-jks --from-file=certs/es-cert.jks\n"))),Object(n.b)("li",{parentName:"ul"},Object(n.b)("p",{parentName:"li"},"Modify the ",Object(n.b)("inlineCode",{parentName:"p"},"app-deploy.yaml")," to add environment variables and mount point."))),Object(n.b)("pre",null,Object(n.b)("code",i({parentName:"pre"},{className:"language-yaml"}),"  env:\n    - name: KAFKA_BROKERS\n      valueFrom:\n        configMapKeyRef:\n          key: brokers\n          name: kafka-brokers\n    - name: KAFKA_APIKEY\n      valueFrom:\n        secretKeyRef:\n          key: binding\n          name: es-cp4i-apikey\n          optional: true\n    - name: CERT_LOCATION\n      value: /config/certs/truststore.jks\n")),Object(n.b)("p",null,"The ",Object(n.b)("a",i({parentName:"p"},{href:"https://appsody.dev/docs/reference/appsody-operator/"}),"Appsody Operator")," is a required prerequisite for deploying the microservice to a remote Kubernetes or OpenShift cluster. If the operator is not present in the current project, ",Object(n.b)("inlineCode",{parentName:"p"},"appsody deploy... ")," will add one."),Object(n.b)("p",null,"To deploy the microservice to a remote cluster:"),Object(n.b)("pre",null,Object(n.b)("code",i({parentName:"pre"},{className:"language-shell"}),"# Get the route to reach the docker private registry\noc get route --all-namespaces | grep registry\n# Define the path as environment variable\nexport IMAGE_REGISTRY=default-route-openshift-image-registry.gse-eda-demo-202005-fa9ee67c9ab6a7791435450358e564cc-0000.us-south.containers.appdomain.cloud\n# Deploy with appsody\n\nappsody deploy -t vaccine-cold-chain/vaccine-order-mgr:0.0.1 --push-url $IMAGE_REGISTRY --push --no-build --namespace vaccine-cold-chain\n")),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},"You can omit the ",Object(n.b)("inlineCode",{parentName:"li"},"--no-build")," flag to have Appsody perform a build before deploying the application."),Object(n.b)("li",{parentName:"ul"},Object(n.b)("em",{parentName:"li"},Object(n.b)("strong",{parentName:"em"},"Note:"))," Performing a build at deploy time requires specifying the absolute container reference path, as well as the ",Object(n.b)("inlineCode",{parentName:"li"},"--push")," flag."),Object(n.b)("li",{parentName:"ul"},"The neccesary deployment parameter information will be read from the ",Object(n.b)("inlineCode",{parentName:"li"},"app-deploy.yaml")," file in the same directory.")),Object(n.b)("h2",null,"Usage Details"),Object(n.b)("h3",null,"REST APIs"),Object(n.b)("p",null,"The REST end point for this service expose the following OpenAPI:"),Object(n.b)("p",null," ",Object(n.b)("span",i({parentName:"p"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}}),"\n      ",Object(n.b)("span",i({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"82.29166666666666%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAACCklEQVQ4y6XUyW/TQBTHcf//EgfEAU4VEkI9FIR6QKgqB1rUqgvdkjRkq9skjuM4i/exZ+z4y8StClzowuGjZ41mfn6jJ9tIEsHu3jGHR2ccHZ9xUbvk284+xz/OOTg84fveIVvbO5yc1vSeU13r9Mwb+rN94nROrgqklCilKkYmFc5CEESCKEm1rKqxyEjSjDTVa1Fc1dXB5bKgLEvKAh3wd1gVGAtJZ5wwmArcIKvMQk3Xha55rrT8/sAq4FZ2H/Z7TWJI3aHMlxTLkkIfzJW6C1HV85+bb6l/MpTeNOqbDMweIokpCt1N9eZb+RNVV96u+3y58Bi4Ee4iZh7KZzN8PYSNZsL6peC8P6NuWgy8BMsXz2J4ach7+ytv7S1qrkl7PGSUzLHiOcNo9mRGkEg+6Q43dIfN4YJ236EznOqph0zjHFdfw40kEz3xSfCwKvBDrWD9fEnLjjFtnys74GYS6dDknu0rxo9QBW42Mj7WM1pWQM+a0Rst6Aym/Lx2dMcubf089lcdSJwH6KEo3tVhrQYNS9C1PLp2iOUpJjE4UVmxg0J3+TAjTULsxmfs2iYT6wrb6jMe9fFmY0LfJfTu+I9jqNhjufeKcvcFQecIp1tnftVA2F1y9xo1MVHu4xly4ZG+WUO+fE2wf4DT6jBttghNE2lZZMPhkxjV9xlHWogUArn6q/yHX485txu4FmjyAAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(n.b)("img",i({parentName:"span"},{className:"gatsby-resp-image-image",alt:"4",title:"4",src:"/vaccine-solution-main/static/57a73d42d89152003de92f0a86f0405f/3cbba/openapi.png",srcSet:["/vaccine-solution-main/static/57a73d42d89152003de92f0a86f0405f/7fc1e/openapi.png 288w","/vaccine-solution-main/static/57a73d42d89152003de92f0a86f0405f/a5df1/openapi.png 576w","/vaccine-solution-main/static/57a73d42d89152003de92f0a86f0405f/3cbba/openapi.png 1152w","/vaccine-solution-main/static/57a73d42d89152003de92f0a86f0405f/7dc98/openapi.png 1200w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    ")))}m.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-solution-orderms-index-mdx-8f4e2545fceba9e9f9d7.js.map